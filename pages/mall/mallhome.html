<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title></title>
<script src="../../js/mui.min.js"></script>
<script src="../../js/setting.js"></script>
<link href="../../css/mui.min.css" rel="stylesheet"/>
<link href="../../css/iconfont.css" rel="stylesheet" type="text/css" />
<link href="../../css/job.css" rel="stylesheet"/>
<script type="text/javascript" charset="UTF-8">
mui.init();
var Dweb = [];
var mallPage;
mui.plusReady(function() {
	document.querySelector('header').addEventListener('tap',function(){
		console.log(thisPage.children().length);
	})
	mui.get(XW.base + 'customize/duiba/login',function(data){
		mallPage = mui.preload({url:data,id:'mallpage',styles:{top:46,bottom:0}})
		plus.webview.currentWebview().append(mallPage);
		mallPage.show();
	});
	//逐一返回上级页面
	mui.back = function(){
		if(Dweb.length != 0 && Dweb.length != 2){
			Dweb.pop().close();
		}else if(Dweb.length == 2){
			Dweb.pop().close();
			Dweb.pop().close();
		}else{
			plus.webview.currentWebview().close();
			mallPage.close();
		}
	}
	mui.later(function(){
			listenLoad(mallPage);
	},500)
})
//拦截页面资源
var listenLoad = function(thisWeb){
	thisWeb.overrideUrlLoading({mode:"reject"},function(e){
		console.log("reject url:"+e.url);
		var web = mui.openWindow({url:e.url,styles:{top: 44,bottom: 0}});
		
		plus.webview.currentWebview().append(web);
		Dweb.push(web);
		listenLoad(web);
	})
}
</script>
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		<a class="mui-action-back mui-icon mui-icon-arrowleft mui-pull-left"></a>
		<h1 class="mui-title">积分商城</h1>
		<!--<iframe></iframe>-->
	</header>
</body>
</html>
